{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.HintCallout = void 0;\n\nvar react_client_1 = require(\"@speechly/react-client\");\n\nvar react_1 = __importStar(require(\"react\"));\n\nvar types_1 = require(\"../types\");\n\nvar Callout_1 = require(\"./Callout\");\n\nvar HintCallout = function (props) {\n  var _a = react_1.useState(false),\n      visible = _a[0],\n      setVisible = _a[1];\n\n  var timeout = react_1.useRef(null);\n  var SHORT_PRESS_TRESHOLD_MS = 600;\n  var INSTRUCTION_PREROLL_MS = 500;\n  var INSTRUCTION_SHOW_TIME_MS = 3000;\n  react_1.useEffect(function () {\n    var subTangentPress = PubSub.subscribe(types_1.SpeechlyUiEvents.TangentPress, function (message, payload) {\n      // console.log('TangentPress', payload.state)\n      hideHints();\n    });\n    var subTangentClick = PubSub.subscribe(types_1.SpeechlyUiEvents.TangentRelease, function (message, payload) {\n      // console.log('TangentRelease ', payload.state, payload.timeMs)\n      // Detect short record button presses\n      if (payload.timeMs < SHORT_PRESS_TRESHOLD_MS) {\n        switch (payload.state) {\n          case react_client_1.SpeechState.Ready:\n          case react_client_1.SpeechState.Recording:\n          case react_client_1.SpeechState.Loading:\n            if (timeout.current === null) {\n              timeout.current = window.setTimeout(function () {\n                setVisible(true);\n                timeout.current = window.setTimeout(function () {\n                  setVisible(false);\n                  timeout.current = null;\n                }, INSTRUCTION_SHOW_TIME_MS);\n              }, INSTRUCTION_PREROLL_MS);\n            }\n\n        }\n      }\n    });\n    return function () {\n      PubSub.unsubscribe(subTangentPress);\n      PubSub.unsubscribe(subTangentClick);\n    };\n  }, []);\n\n  var hideHints = function () {\n    setVisible(false);\n\n    if (timeout.current !== null) {\n      clearTimeout(timeout.current);\n      timeout.current = null;\n    }\n  };\n\n  return react_1.default.createElement(Callout_1.Callout, {\n    sourceAnchors: {\n      x: '50%',\n      y: '6%'\n    },\n    visible: visible,\n    onClick: function () {\n      return hideHints();\n    }\n  }, \"Hold to talk\");\n};\n\nexports.HintCallout = HintCallout;","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AAEO,IAAMA,WAAW,GAAa,iBAAK;AAClC,WAAwBC,iBAAkB,KAAlB,CAAxB;AAAA,MAACC,OAAO,QAAR;AAAA,MAAUC,UAAU,QAApB;;AACN,MAAMC,OAAO,GAAGH,eAAsB,IAAtB,CAAhB;AAEA,MAAMI,uBAAuB,GAAG,GAAhC;AACA,MAAMC,sBAAsB,GAAG,GAA/B;AACA,MAAMC,wBAAwB,GAAG,IAAjC;AAEAN,oBAAU;AACR,QAAMO,eAAe,GAAGC,MAAM,CAACC,SAAP,CACtBC,yBAAiBC,YADK,EAEtB,UAACC,OAAD,EAAkBC,OAAlB,EAAiD;AAC/C;AACAC,eAAS;AACV,KALqB,CAAxB;AAOA,QAAMC,eAAe,GAAGP,MAAM,CAACC,SAAP,CACtBC,yBAAiBM,cADK,EAEtB,UAACJ,OAAD,EAAkBC,OAAlB,EAAiE;AAC/D;AACA;AACA,UAAIA,OAAO,CAACI,MAAR,GAAiBb,uBAArB,EAA8C;AAC5C,gBAAQS,OAAO,CAACK,KAAhB;AACE,eAAKC,2BAAYC,KAAjB;AACA,eAAKD,2BAAYE,SAAjB;AACA,eAAKF,2BAAYG,OAAjB;AACE,gBAAInB,OAAO,CAACoB,OAAR,KAAoB,IAAxB,EAA8B;AAC5BpB,qBAAO,CAACoB,OAAR,GAAkBC,MAAM,CAACC,UAAP,CAAkB;AAClCvB,0BAAU,CAAC,IAAD,CAAV;AACAC,uBAAO,CAACoB,OAAR,GAAkBC,MAAM,CAACC,UAAP,CAAkB;AAClCvB,4BAAU,CAAC,KAAD,CAAV;AACAC,yBAAO,CAACoB,OAAR,GAAkB,IAAlB;AACD,iBAHiB,EAGfjB,wBAHe,CAAlB;AAID,eANiB,EAMfD,sBANe,CAAlB;AAOD;;AAZL;AAcD;AACF,KArBqB,CAAxB;AAuBA,WAAO;AACLG,YAAM,CAACkB,WAAP,CAAmBnB,eAAnB;AACAC,YAAM,CAACkB,WAAP,CAAmBX,eAAnB;AACD,KAHD;AAID,GAnCD,EAmCG,EAnCH;;AAqCA,MAAMD,SAAS,GAAG;AAChBZ,cAAU,CAAC,KAAD,CAAV;;AACA,QAAIC,OAAO,CAACoB,OAAR,KAAoB,IAAxB,EAA8B;AAC5BI,kBAAY,CAACxB,OAAO,CAACoB,OAAT,CAAZ;AACApB,aAAO,CAACoB,OAAR,GAAkB,IAAlB;AACD;AACF,GAND;;AAQA,SAAOvB,8BAAC4B,iBAAD,EAAQ;AAACC,iBAAa,EAAE;AAAEC,OAAC,EAAE,KAAL;AAAYC,OAAC,EAAE;AAAf,KAAhB;AAAuC9B,WAAO,EAAEA,OAAhD;AAAyD+B,WAAO,EAAE;AAAM,sBAAS,EAAT;AAAW;AAAnF,GAAR,EAA2F,cAA3F,CAAP;AACD,CAtDM;;AAAMC,sBAAWlC,WAAX","names":["HintCallout","react_1","visible","setVisible","timeout","SHORT_PRESS_TRESHOLD_MS","INSTRUCTION_PREROLL_MS","INSTRUCTION_SHOW_TIME_MS","subTangentPress","PubSub","subscribe","types_1","TangentPress","message","payload","hideHints","subTangentClick","TangentRelease","timeMs","state","react_client_1","Ready","Recording","Loading","current","window","setTimeout","unsubscribe","clearTimeout","Callout_1","sourceAnchors","x","y","onClick","exports"],"sources":["../../src/components/HintCallout.tsx"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}